(window.webpackJsonp=window.webpackJsonp||[]).push([[354],{628:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[s("strong",[t._v("Spring Cloud Gateway")])]),t._v(" "),s("p",[t._v("网关作为流量入口，具有路由转发，权限校验，限流等功能；")]),t._v(" "),s("p",[t._v("Spring Cloud Gateway 是 Spring cloud 官方推出的第二代网关框架，定位于取代 Netflix Zuul1.0;")]),t._v(" "),s("p",[t._v("Spring Cloud Gateway 是由"),s("strong",[t._v("WebFlux+Netty+Reactor 实现的响应式的 API 网关")]),t._v("。"),s("strong",[t._v("不能在传统的 servlet 容器中工作，不能构建成 war 包")])]),t._v(" "),s("p",[t._v("Spring Cloud Gateway 旨在为微服务架构提供简单有效的 API 路由管理方式，"),s("strong",[t._v("基于 Filter 的方式")]),t._v("提供网关的基本功能，例如安全认证、监控、限流等等")]),t._v(" "),s("p",[s("strong",[t._v("功能特征")])]),t._v(" "),s("ul",[s("li",[t._v("基于 Spring Framework 5、Project Reactor 和 Spring Boot 2.0 进行构建")]),t._v(" "),s("li",[t._v("动态路由：能够匹配任何请求属性")]),t._v(" "),s("li",[t._v("支持路径重写")]),t._v(" "),s("li",[t._v("集成 Spring Cloud 服务发现功能（Nacos，Eureka）")]),t._v(" "),s("li",[t._v("可集成流控降级功能（Sentinel、Hystrix)")]),t._v(" "),s("li",[t._v("可以对路由指定易于编写的 Predicate(断言)和 Filter(过滤器)\n"),s("strong",[t._v("核心概念")])])]),t._v(" "),s("p",[t._v("一、路由（route）")]),t._v(" "),s("p",[t._v("网关中最基础的部分；路由信息包括一个 ID，一个目的 URI，一组断言工厂，一组 Filter；")]),t._v(" "),s("p",[t._v("如果断言为真，说明请求的 URI 和配置的路由匹配")]),t._v(" "),s("p",[t._v("二、断言（predicates)")]),t._v(" "),s("p",[t._v("Java8 中的断言函数，Spring Cloud Gateway 中的断言函数类型是 Spring5.0 框架中的 ServerWebExchange。")]),t._v(" "),s("p",[t._v("断言函数允许开发者去定义匹配 Http request 中的任何信息，比如请求头和参数等；")]),t._v(" "),s("p",[t._v("三、过滤器（Filter）")]),t._v(" "),s("p",[t._v("Spring Cloud Gateway 中的 Filter 分为 Gateway Filter 和 Global Filter。Filter 可以对请求和响应进行处理。")]),t._v(" "),s("p",[s("strong",[t._v("工作原理")])]),t._v(" "),s("p",[t._v("暂不介绍")]),t._v(" "),s("p",[s("strong",[t._v("快速开始")])]),t._v(" "),s("p",[t._v("<1>引入依赖")]),t._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.cloud"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-cloud-starter-gateway"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("<2>application.yml 配置")]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gateway\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cloud")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 网关配置")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gateway")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 路由规则")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("routes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" order_route\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9001")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 转发到order服务")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("predicates")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Path=/order"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service/"),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("**")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http://127.0.0.1:8080/order-service/order/add/byFeign?id=1 -> http://127.0.0.1:9001/order-service/order/add/byFeign?id=1")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" StripPrefix=1 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 转发前去掉第一层路径")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http://127.0.0.1:9001/order/add/byFeign?id=1")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);