(window.webpackJsonp=window.webpackJsonp||[]).push([[235],{509:function(t,a,r){"use strict";r.r(a);var s=r(14),e=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"zookeeper-服务注册与发现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper-服务注册与发现"}},[t._v("#")]),t._v(" Zookeeper 服务注册与发现")]),t._v(" "),a("h3",{attrs:{id:"启动-zk-到-linux-上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-zk-到-linux-上"}},[t._v("#")]),t._v(" 启动 zk,到 linux 上")]),t._v(" "),a("p",[t._v("129.0.4.32:2181,129.0.4.33:2181,129.0.4.34:2181")]),t._v(" "),a("h3",{attrs:{id:"创建新的-pay-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建新的-pay-模块"}},[t._v("#")]),t._v(" 创建新的 pay 模块,")]),t._v(" "),a("p",[t._v("单独用于注册到 zk 中")]),t._v(" "),a("p",[t._v("名字: cloud_pay_8003")]),t._v(" "),a("h4",{attrs:{id:"pom-依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pom-依赖"}},[t._v("#")]),t._v(" pom 依赖")]),t._v(" "),a("h4",{attrs:{id:"配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/zookeeper%E7%9A%843.png",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"主启动类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主启动类"}},[t._v("#")]),t._v(" 主启动类")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/zookeeper%E7%9A%841.png",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"controller"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#controller"}},[t._v("#")]),t._v(" controller")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/zookeeper%E7%9A%842.png",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"然后就可以启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#然后就可以启动"}},[t._v("#")]),t._v(" 然后就可以启动")]),t._v(" "),a("p",[a("strong",[t._v("此时启动,会报错,因为 jar 包与我们的 zk 版本不匹配")])]),t._v(" "),a("p",[t._v("解决:")]),t._v(" "),a("p",[t._v("修改 pom 文件,改为与我们 zk 版本匹配的 jar 包")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/zookeeper%E7%9A%844.png",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("此时 8003 就注册到 zk 中了")])]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("我们在zk上注册的node是临时节点"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("当我们的服务一定时间内没有发送心跳\n  \t那么zk就会`将这个服务的node删除了\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[a("strong",[t._v("这里测试,就不写 service 与 dao 什么的了")])]),t._v(" "),a("h3",{attrs:{id:"创建-order-消费模块注册到-zk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建-order-消费模块注册到-zk"}},[t._v("#")]),t._v(" 创建 order 消费模块注册到 zk")]),t._v(" "),a("h4",{attrs:{id:"创建项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建项目"}},[t._v("#")]),t._v(" 创建项目")]),t._v(" "),a("p",[t._v("名字: cloud_order_zk_80")]),t._v(" "),a("h4",{attrs:{id:"pom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pom"}},[t._v("#")]),t._v(" pom")]),t._v(" "),a("h4",{attrs:{id:"配置文件-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件-2"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/zookeeper%E7%9A%845.png",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"主启动类-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主启动类-2"}},[t._v("#")]),t._v(" 主启动类:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/zookeeper%E7%9A%841.png",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"resttemolate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#resttemolate"}},[t._v("#")]),t._v(" RestTemolate")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/zookeeper%E7%9A%846.png",alt:"注意,这里使用RestTemolate,要先注册它"}})]),t._v(" "),a("h4",{attrs:{id:"controller-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#controller-2"}},[t._v("#")]),t._v(" controller")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/zookeeper%E7%9A%847.png",alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);