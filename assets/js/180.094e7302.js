(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{454:function(s,t,a){"use strict";a.r(t);var n=a(14),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"xxl-job-文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#xxl-job-文档"}},[s._v("#")]),s._v(" XXL-JOB 文档")]),s._v(" "),t("h2",{attrs:{id:"部署步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#部署步骤"}},[s._v("#")]),s._v(" 部署步骤")]),s._v(" "),t("p",[s._v("1、下载 Githup 项目https://github.com/xuxueli/xxl-job")]),s._v(" "),t("p",[s._v("2、执行项目 doc/db/tables_xxl_job.sql 文件在数据库中，此为调度平台的表创建 sql 脚本文件，记录任务的执行，用户信息等信息")]),s._v(" "),t("p",[s._v("3、xxl-job-admin 此为项目的调度平台，本身是一个 springboot 项目，在 resource/applications.properties 中修改 mysql 的 host，user，password 信息，此项目就配置完毕，然后即可启动，登录网址：http://localhost:8080/xxl-job-admin/ 账号：admin， 密码：123456")]),s._v(" "),t("p",[s._v("4、xxl-job-executor-sample-springboot 此为任务执行平台， resource/applications.properties 修改 xxl.job.admin.addresses 的配置，修改为 xxl-job-admin 的登录网址，例如：http://localhost:8080/xxl-job-admin/ 如此，任务执行平台部署完毕")]),s._v(" "),t("p",[s._v("5、如此单实例部署服务完成")]),s._v(" "),t("h2",{attrs:{id:"服务介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务介绍"}},[s._v("#")]),s._v(" 服务介绍")]),s._v(" "),t("p",[s._v("调度服务主要分为以下几个模块，")]),s._v(" "),t("p",[s._v("Ø 运行报表，显示任务的运行情况，成功失败的比例等任务信息")]),s._v(" "),t("p",[s._v("Ø 任务管理，此为任务调度的配置模块，任务在此模块进行配置")]),s._v(" "),t("p",[s._v("Ø 调度日志，任务日志的运行情况，通过日志进行观察")]),s._v(" "),t("p",[s._v("4、执行器管理，执行任务的服务可以部署多个，多个服务在此进行配置")]),s._v(" "),t("p",[s._v("5、用户管理模块")]),s._v(" "),t("p",[s._v("6、官方使用教程")]),s._v(" "),t("p",[s._v("执行器管理模块详细介绍：")]),s._v(" "),t("p",[s._v("AppName 一般是你的 spingboot 的 server_name")]),s._v(" "),t("p",[s._v("名称：不做限制")]),s._v(" "),t("p",[s._v("注册方式：自动注册，如果服务中配置了 xxl.job.admin.addresses，那么调度服务可以进行自动发现，也可以采用手动注册的方式，同一个机器部署多个或者是部署在不同机器，ip:端口，用逗号进行分割")]),s._v(" "),t("p",[s._v("任务管理模块详细介绍：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://muyids.oss-cn-beijing.aliyuncs.com/img/202204211633633.png",alt:"img"}})]),s._v(" "),t("p",[s._v("Ø 执行器：在执行器管理模块中可以配置多个执行器，在此可以进行选择")]),s._v(" "),t("p",[s._v("Ø 任务描述：执行任务的功能性描述")]),s._v(" "),t("p",[s._v("Ø 负责人：开发责任人")]),s._v(" "),t("p",[s._v("Ø 报警邮件：邮件地址，逗号分隔")]),s._v(" "),t("p",[s._v("Ø 调度类型：cron 表示采用定时的方式进行调度，亦可以不设置调度类型")]),s._v(" "),t("p",[s._v("Ø Cron：即定时时间配置")]),s._v(" "),t("p",[s._v("Ø 运行模式：bean 即 java 开发模式")]),s._v(" "),t("p",[s._v('Ø JobHandle: 需要你代码中开发的注解名字保持一致，例如@XxlJob("demoJobHandler")')]),s._v(" "),t("p",[s._v("Ø 任务参数：可以选择入参，代码中获取参数 String param = XxlJobHelper.getJobParam();")]),s._v(" "),t("p",[s._v("Ø 路由策略：FIRST（第一个）：固定选择第一个机器，")]),s._v(" "),t("p",[s._v("LAST（最后一个）：固定选择最后一个机器；")]),s._v(" "),t("p",[s._v("ROUND（轮询）： 按个机器执行；")]),s._v(" "),t("p",[s._v("RANDOM（随机）：随机选择在线的机器；")]),s._v(" "),t("p",[s._v("CONSISTENT_HASH（一致性 HASH）：每个任务按照 Hash 算法固定选择某一台机器，且所有任务均匀散列在不同机器上。")]),s._v(" "),t("p",[s._v("LEAST_FREQUENTLY_USED（最不经常使用）：使用频率最低的机器优先被选举；")]),s._v(" "),t("p",[s._v("LEAST_RECENTLY_USED（最近最久未使用）：最久未使用的机器优先被选举；")]),s._v(" "),t("p",[s._v("FAILOVER（故障转移）：按照顺序依次进行心跳检测，第一个心跳检测成功的机器选定为目标执行器并发起调度；")]),s._v(" "),t("p",[s._v("BUSYOVER（忙碌转移）：按照顺序依次进行空闲检测，第一个空闲检测成功的机器选定为目标执行器并发起调度；")]),s._v(" "),t("p",[s._v("SHARDING_BROADCAST(分片广播)：广播触发对应集群中所有机器执行一次任务，同时系统自动传递分片参数；可根据分片参数开发分片任务；")]),s._v(" "),t("p",[s._v("Ø 子任务 ID：当前任务执行完成后，执行子任务，如果有多个子任务用逗号分隔")]),s._v(" "),t("p",[s._v("Ø 调度过期策略：立即执行一次或者是忽略")]),s._v(" "),t("p",[s._v("Ø 阻塞处理策略：调度过于密集执行器来不及处理时的处理策略；")]),s._v(" "),t("p",[s._v("单机串行（默认）：调度请求进入单机执行器后，调度请求进入 FIFO 队列并以串行方式运行")]),s._v(" "),t("p",[s._v("丢弃后续调度：调度请求进入单机执行器后，发现执行器存在运行的调度任务，本次请求将会被丢弃并标记为失败；")]),s._v(" "),t("p",[s._v("覆盖之前调度：调度请求进入单机执行器后，发现执行器存在运行的调度任务，将会终止运行中的调度任务并清空队列，然后运行本地调度任务；")]),s._v(" "),t("p",[s._v("Ø 任务超时时间：支持自定义任务超时时间，任务运行超时将会主动中断任务；")]),s._v(" "),t("p",[s._v("Ø 失败重试次数；支持自定义任务失败重试次数，当任务失败时将会按照预设的失败重试次数主动进行重试")]),s._v(" "),t("h2",{attrs:{id:"开发样例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开发样例"}},[s._v("#")]),s._v(" 开发样例：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SampleXxlJob")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger")]),s._v(" logger "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LoggerFactory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getLogger")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SampleXxlJob")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 1、简单任务示例（Bean模式）\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@XxlJob")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"demoJobHandler"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("demoJobHandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    获取输入的参数")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" param "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("XxlJobHelper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getJobParam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    此为xxl的log日志，方便后续定是任务的追踪，用此日志类打印的日志可以在调度控制台上查看")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("XxlJobHelper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("param"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("XxlJobHelper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"XXL-JOB, Hello World."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//      定制化业务代码")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("XxlJobHelper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"beat at:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"beat at:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SECONDS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// default success")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);