(window.webpackJsonp=window.webpackJsonp||[]).push([[234],{507:function(a,r,t){"use strict";t.r(r);var s=t(14),e=Object(s.a)({},(function(){var a=this,r=a._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h2",{attrs:{id:"eureka"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#eureka"}},[a._v("#")]),a._v(" Eureka:")]),a._v(" "),r("p",[a._v("前面我们没有服务注册中心,也可以服务间调用,为什么还要服务注册?")]),a._v(" "),r("p",[a._v("当服务很多时,单靠代码手动管理是很麻烦的,需要一个公共组件,统一管理多服务,包括服务是否正常运行,等")]),a._v(" "),r("p",[a._v("Eureka 用于**==服务注册=="),r("strong",[a._v(",目前官网")]),a._v("已经停止更新**")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%841.png",alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%842.png",alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%843.png",alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%844.png",alt:""}})]),a._v(" "),r("h3",{attrs:{id:"单机版-eureka"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#单机版-eureka"}},[a._v("#")]),a._v(" "),r("strong",[a._v("单机版 eureka:")])]),a._v(" "),r("h4",{attrs:{id:"创建项目-cloud-eureka-server-7001"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#创建项目-cloud-eureka-server-7001"}},[a._v("#")]),a._v(" "),r("strong",[a._v("创建项目 cloud_eureka_server_7001")])]),a._v(" "),r("h4",{attrs:{id:"引入-pom-依赖"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#引入-pom-依赖"}},[a._v("#")]),a._v(" "),r("strong",[a._v("引入 pom 依赖")])]),a._v(" "),r("p",[a._v("​eurka 最新的依赖变了")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%845.png",alt:""}})]),a._v(" "),r("h4",{attrs:{id:"配置文件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[a._v("#")]),a._v(" 配置文件:")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%846.png",alt:""}})]),a._v(" "),r("h4",{attrs:{id:"主启动类"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#主启动类"}},[a._v("#")]),a._v(" 主启动类")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%847.png",alt:""}})]),a._v(" "),r("h4",{attrs:{id:"此时就可以启动当前项目了"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#此时就可以启动当前项目了"}},[a._v("#")]),a._v(" "),r("strong",[a._v("此时就可以启动当前项目了")])]),a._v(" "),r("h4",{attrs:{id:"其他服务注册到-eureka"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#其他服务注册到-eureka"}},[a._v("#")]),a._v(" "),r("strong",[a._v("其他服务注册到 eureka:")])]),a._v(" "),r("p",[a._v("比如此时 pay 模块加入 eureka:")]),a._v(" "),r("h5",{attrs:{id:"主启动类上-加注解-表示当前是-eureka-客户端"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#主启动类上-加注解-表示当前是-eureka-客户端"}},[a._v("#")]),a._v(" 主启动类上,加注解,表示当前是 eureka 客户端")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8410.png",alt:""}})]),a._v(" "),r("h5",{attrs:{id:"修改-pom-引入"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改-pom-引入"}},[a._v("#")]),a._v(" 修改 pom,引入")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%848.png",alt:""}})]),a._v(" "),r("h5",{attrs:{id:"修改配置文件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[a._v("#")]),a._v(" 修改配置文件:")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%849.png",alt:""}})]),a._v(" "),r("h5",{attrs:{id:"pay-模块重启-就可以注册到-eureka-中了"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pay-模块重启-就可以注册到-eureka-中了"}},[a._v("#")]),a._v(" pay 模块重启,就可以注册到 eureka 中了")]),a._v(" "),r("p",[r("strong",[a._v("==order 模块的注册是一样的==")])]),a._v(" "),r("h3",{attrs:{id:"集群版-eureka"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#集群版-eureka"}},[a._v("#")]),a._v(" 集群版 eureka:")]),a._v(" "),r("h4",{attrs:{id:"集群原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#集群原理"}},[a._v("#")]),a._v(" 集群原理:")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8411.png",alt:""}})]),a._v(" "),r("div",{staticClass:"language-java line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-java"}},[r("code",[r("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.")]),a._v(" 就是pay模块启动时"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("注册自己"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("并且自身信息也放入eureka\n"),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.")]),a._v(" order模块"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("首先也注册自己"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("放入信息"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("当要调用pay时"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("先从eureka拿到pay的调用地址\n"),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.")]),a._v(" 通过"),r("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HttpClient")]),a._v("调用\n \t并且还会缓存一份到本地"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("每"),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v("秒更新一次\n")])]),a._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[a._v("1")]),r("br"),r("span",{staticClass:"line-number"},[a._v("2")]),r("br"),r("span",{staticClass:"line-number"},[a._v("3")]),r("br"),r("span",{staticClass:"line-number"},[a._v("4")]),r("br")])]),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8412.png",alt:""}})]),a._v(" "),r("p",[r("strong",[a._v("集群构建原理:")])]),a._v(" "),r("p",[a._v("互相注册")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8413.png",alt:""}})]),a._v(" "),r("h4",{attrs:{id:"构建新-erueka-项目"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#构建新-erueka-项目"}},[a._v("#")]),a._v(" "),r("strong",[a._v("构建新 erueka 项目")])]),a._v(" "),r("p",[a._v("名字:cloud_eureka_server_7002")]),a._v(" "),r("h5",{attrs:{id:"pom-文件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pom-文件"}},[a._v("#")]),a._v(" pom 文件:")]),a._v(" "),r("p",[a._v("粘贴 7001 的即可")]),a._v(" "),r("h5",{attrs:{id:"配置文件-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#配置文件-2"}},[a._v("#")]),a._v(" 配置文件:")]),a._v(" "),r("p",[a._v("在写配置文件前,修改一下主机的 hosts 文件")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8414.png",alt:""}})]),a._v(" "),r("p",[a._v("首先修改之前的 7001 的 eureka 项目,因为多个 eureka 需要互相注册")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8415.png",alt:""}})]),a._v(" "),r("p",[a._v("然后修改 7002")]),a._v(" "),r("p",[r("strong",[a._v("7002 也是一样的,只不过端口和地址改一下")])]),a._v(" "),r("h5",{attrs:{id:"主启动类-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#主启动类-2"}},[a._v("#")]),a._v(" 主启动类:")]),a._v(" "),r("p",[a._v("复制 7001 的即可")]),a._v(" "),r("h5",{attrs:{id:"然后启动-7001-7002-即可"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#然后启动-7001-7002-即可"}},[a._v("#")]),a._v(" 然后启动 7001,7002 即可")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8416.png",alt:""}})]),a._v(" "),r("h4",{attrs:{id:"将-pay-order-模块注册到-eureka-集群中"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#将-pay-order-模块注册到-eureka-集群中"}},[a._v("#")]),a._v(" 将 pay,order 模块注册到 eureka 集群中:")]),a._v(" "),r("h5",{attrs:{id:"只需要修改配置文件即可"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#只需要修改配置文件即可"}},[a._v("#")]),a._v(" 只需要修改配置文件即可:")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8417.png",alt:""}})]),a._v(" "),r("h5",{attrs:{id:"两个模块都修改上面的都一样即可"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#两个模块都修改上面的都一样即可"}},[a._v("#")]),a._v(" 两个模块都修改上面的都一样即可")]),a._v(" "),r("p",[a._v("然后启动两个模块")]),a._v(" "),r("p",[a._v("要先启动 7001,7002,然后是 pay 模块 8001,然后是 order(80)")]),a._v(" "),r("h3",{attrs:{id:"将-pay-模块也配置为集群模式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#将-pay-模块也配置为集群模式"}},[a._v("#")]),a._v(" 将 pay 模块也配置为集群模式:")]),a._v(" "),r("h4",{attrs:{id:"创建新模块-8002"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#创建新模块-8002"}},[a._v("#")]),a._v(" 创建新模块,8002")]),a._v(" "),r("p",[a._v("​ 名称: cloud_pay_8002")]),a._v(" "),r("h4",{attrs:{id:"pom-文件-复制-8001-的"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pom-文件-复制-8001-的"}},[a._v("#")]),a._v(" pom 文件,复制 8001 的")]),a._v(" "),r("h4",{attrs:{id:"pom-文件复制-8001-的"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pom-文件复制-8001-的"}},[a._v("#")]),a._v(" pom 文件复制 8001 的")]),a._v(" "),r("h4",{attrs:{id:"配置文件复制-8001-的"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#配置文件复制-8001-的"}},[a._v("#")]),a._v(" 配置文件复制 8001 的")]),a._v(" "),r("p",[a._v("端口修改一下,改为 8002")]),a._v(" "),r("p",[a._v("服务名称不用改,用一样的")]),a._v(" "),r("h4",{attrs:{id:"主启动类-复制-8001-的"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#主启动类-复制-8001-的"}},[a._v("#")]),a._v(" 主启动类,复制 8001 的")]),a._v(" "),r("h4",{attrs:{id:"mapper-service-controller-都复制一份"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mapper-service-controller-都复制一份"}},[a._v("#")]),a._v(" mapper,service,controller 都复制一份")]),a._v(" "),r("p",[a._v("然后就启动服务即可")]),a._v(" "),r("p",[a._v("​ 此时访问 order 模块,发现并没有负载均衡到两个 pay,模块中,而是只访问 8001")]),a._v(" "),r("p",[a._v("​ 虽然我们是使用 RestTemplate 访问的微服务,但是也可以负载均衡的")]),a._v(" "),r("p",[a._v("​"),r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8418.png",alt:""}})]),a._v(" "),r("p",[r("strong",[a._v("注意这样还不可以,需要让 RestTemplate 开启负载均衡注解,还可以指定负载均衡算法,默认轮询")])]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8419.png",alt:""}})]),a._v(" "),r("h3",{attrs:{id:"修改服务主机名和-ip-在-eureka-的-web-上显示"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改服务主机名和-ip-在-eureka-的-web-上显示"}},[a._v("#")]),a._v(" 修改服务主机名和 ip 在 eureka 的 web 上显示")]),a._v(" "),r("p",[a._v("比如修改 pay 模块")]),a._v(" "),r("h4",{attrs:{id:"修改配置文件-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件-2"}},[a._v("#")]),a._v(" 修改配置文件:")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8420.png",alt:""}})]),a._v(" "),r("h3",{attrs:{id:"eureka-服务发现"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#eureka-服务发现"}},[a._v("#")]),a._v(" eureka 服务发现:")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8421.png",alt:""}})]),a._v(" "),r("p",[a._v("以 pay 模块为例")]),a._v(" "),r("h4",{attrs:{id:"_1-首先添加一个注解-在-controller-中"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-首先添加一个注解-在-controller-中"}},[a._v("#")]),a._v(" 1,首先添加一个注解,在 controller 中")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8422.png",alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8423.png",alt:""}})]),a._v(" "),r("h4",{attrs:{id:"_2-在主启动类上添加一个注解"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-在主启动类上添加一个注解"}},[a._v("#")]),a._v(" 2,在主启动类上添加一个注解")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8424.png",alt:""}})]),a._v(" "),r("p",[r("strong",[a._v("然后重启 8001.访问/payment/discover")]),a._v("y")]),a._v(" "),r("h3",{attrs:{id:"_6-eureka-自我保护"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-eureka-自我保护"}},[a._v("#")]),a._v(" 6,Eureka 自我保护:")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8426.png",alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8427.png",alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8425.png",alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Eureka%E7%9A%8428.png",alt:""}})]),a._v(" "),r("p",[r("strong",[a._v("eureka 服务端配置:")])])])}),[],!1,null,null,null);r.default=e.exports}}]);