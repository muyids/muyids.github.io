(window.webpackJsonp=window.webpackJsonp||[]).push([[415],{689:function(e,a,s){"use strict";s.r(a);var l=s(14),t=Object(l.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"helm-安装-mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-安装-mysql"}},[e._v("#")]),e._v(" Helm 安装 mysql")]),e._v(" "),a("h2",{attrs:{id:"helm-search-查找-charts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-search-查找-charts"}},[e._v("#")]),e._v(" Helm search: 查找 Charts")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("helm search hub")]),e._v(" 从 "),a("a",{attrs:{href:"https://artifacthub.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Artifact Hub"),a("OutboundLink")],1),e._v(" 中查找并列出 helm charts。 Artifact Hub 中存放了大量不同的仓库。")]),e._v(" "),a("li",[a("code",[e._v("helm search repo")]),e._v(" 从你添加（使用 "),a("code",[e._v("helm repo add")]),e._v("）到本地 helm 客户端中的仓库中进行查找。该命令基于本地数据进行搜索，无需连接互联网。")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" helm search repo mysql\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("​")]),e._v(" "),a("h2",{attrs:{id:"helm-install-安装一个-helm-包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-install-安装一个-helm-包"}},[e._v("#")]),e._v(" 'helm install'：安装一个 helm 包")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" helm install dw-mysql bitnami/mysql\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"安装前自定义-chart"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装前自定义-chart"}},[e._v("#")]),e._v(" "),a("em",[e._v("安装前自定义 chart")])]),e._v(" "),a("p",[e._v("helm show values 查看 chart 可配置选项")]),e._v(" "),a("p",[e._v("输出到 yaml 文件中")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" helm show values bitnami/mysql --debug > mysql.yaml\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("修改 mysql.yaml，使用自定义配置 安装")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\n helm install -f mysql.yaml dw-mysql bitnami/mysql\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("安装过程中有两种方式传递配置数据：")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("--values")]),e._v(" (或 "),a("code",[e._v("-f")]),e._v(")：使用 YAML 文件覆盖配置。可以指定多次，优先使用最右边的文件。")]),e._v(" "),a("li",[a("code",[e._v("--set")]),e._v("：通过命令行的方式对指定项进行覆盖。")])]),e._v(" "),a("h3",{attrs:{id:"更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新"}},[e._v("#")]),e._v(" 更新")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("helm upgrade -f bitnami/mysql/values.yaml dw-mysql bitnami/mysql\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"更多安装方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更多安装方法"}},[e._v("#")]),e._v(" 更多安装方法")]),e._v(" "),a("p",[a("code",[e._v("helm install")]),e._v(" 命令可以从多个来源进行安装：")]),e._v(" "),a("ul",[a("li",[e._v("chart 的仓库（如上所述）")]),e._v(" "),a("li",[e._v("本地 chart 压缩包（"),a("code",[e._v("helm install foo foo-0.1.1.tgz")]),e._v("）")]),e._v(" "),a("li",[e._v("解压后的 chart 目录（"),a("code",[e._v("helm install foo path/to/foo")]),e._v("）")]),e._v(" "),a("li",[e._v("完整的 URL（"),a("code",[e._v("helm install foo https://example.com/charts/foo-1.2.3.tgz")]),e._v("）")])]),e._v(" "),a("h3",{attrs:{id:"helm-rollback-回滚-release-版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-rollback-回滚-release-版本"}},[e._v("#")]),e._v(" Helm rollback 回滚 release 版本")]),e._v(" "),a("p",[e._v("每当发生了一次安装、升级或回滚操作，revision 的值就会加 1。第一次 revision 的值永远是 1。")]),e._v(" "),a("p",[e._v("回滚到 最初版本：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("helm rollback dw-mysql 1\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"helm-history-查看历史版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-history-查看历史版本"}},[e._v("#")]),e._v(" helm history 查看历史版本")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("helm history dw-mysql\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"helm-status-查看-release-状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-status-查看-release-状态"}},[e._v("#")]),e._v(" helm status 查看 release 状态")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("helm status dw-mysql\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"helm-uninstall-卸载-release"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-uninstall-卸载-release"}},[e._v("#")]),e._v(" 'helm uninstall'：卸载 release")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("helm uninstall dw-mysql\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[a("code",[e._v("helm list")]),e._v(" 命令看到当前部署的所有 release")]),e._v(" "),a("p",[a("code",[e._v("helm list --all")]),e._v(" 会展示 Helm 保留的所有 release 记录，包括失败或删除的条目（指定了 "),a("code",[e._v("--keep-history")]),e._v("）")]),e._v(" "),a("h1",{attrs:{id:"创建自己的-charts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建自己的-charts"}},[e._v("#")]),e._v(" 创建自己的 charts")]),e._v(" "),a("h2",{attrs:{id:"helm-create-初始化模板项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-create-初始化模板项目"}},[e._v("#")]),e._v(" helm create 初始化模板项目")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ helm create deis-workflow\nCreating deis-workflow\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h3",{attrs:{id:"helm-lint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-lint"}},[e._v("#")]),e._v(" "),a("code",[e._v("helm lint")])]),e._v(" "),a("p",[e._v("在编辑 chart 时，可以通过 "),a("code",[e._v("helm lint")]),e._v(" 验证格式是否正确。")]),e._v(" "),a("h3",{attrs:{id:"helm-package"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-package"}},[e._v("#")]),e._v(" "),a("code",[e._v("helm package")])]),e._v(" "),a("p",[e._v("当准备将 chart 打包分发时，你可以运行 "),a("code",[e._v("helm package")]),e._v(" 命令：")]),e._v(" "),a("h3",{attrs:{id:"helm-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-install"}},[e._v("#")]),e._v(" helm install")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("helm install deis-workflow ./deis-workflow-0.1.0.tgz\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h1",{attrs:{id:"二次开发-已有的-charts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二次开发-已有的-charts"}},[e._v("#")]),e._v(" 二次开发 已有的 charts")]),e._v(" "),a("h2",{attrs:{id:"helm-pull-拉取已有-charts-到本地"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-pull-拉取已有-charts-到本地"}},[e._v("#")]),e._v(" helm pull 拉取已有 charts 到本地")]),e._v(" "),a("p",[e._v("从仓库下载并（可选）在本地目录解压")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("helm pull bitnami/mysql --untar\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"修改-values-yaml-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改-values-yaml-文件"}},[e._v("#")]),e._v(" 修改 values.yaml 文件")]),e._v(" "),a("h2",{attrs:{id:"helm-template-编译成-k8s-all-yaml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#helm-template-编译成-k8s-all-yaml"}},[e._v("#")]),e._v(" Helm template 编译成 k8s-all.yaml")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("helm template bitnami/mysql > target/mysql-all.yaml\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("​")]),e._v(" "),a("h2",{attrs:{id:"kubectl-slice-分解-k8s-all-yaml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl-slice-分解-k8s-all-yaml"}},[e._v("#")]),e._v(" kubectl-slice 分解 k8s-all.yaml")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl-slice -f target/mysql-all.yaml -o target/mysql\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"kubectl-apply-部署调试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl-apply-部署调试"}},[e._v("#")]),e._v(" kubectl apply 部署调试")]),e._v(" "),a("p",[e._v("按照 helm 的部署顺序手动部署 分解出来的 k8s 组件")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://helm.sh/zh/docs/intro/using_helm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Helm 按照以下顺序安装资源："),a("OutboundLink")],1)]),e._v(" "),a("ul",[a("li",[e._v("Namespace")]),e._v(" "),a("li",[e._v("NetworkPolicy")]),e._v(" "),a("li",[e._v("ResourceQuota")]),e._v(" "),a("li",[e._v("LimitRange")]),e._v(" "),a("li",[e._v("PodSecurityPolicy")]),e._v(" "),a("li",[e._v("PodDisruptionBudget")]),e._v(" "),a("li",[e._v("ServiceAccount")]),e._v(" "),a("li",[e._v("Secret")]),e._v(" "),a("li",[e._v("SecretList")]),e._v(" "),a("li",[e._v("ConfigMap")]),e._v(" "),a("li",[e._v("StorageClass")]),e._v(" "),a("li",[e._v("PersistentVolume")]),e._v(" "),a("li",[e._v("PersistentVolumeClaim")]),e._v(" "),a("li",[e._v("CustomResourceDefinition")]),e._v(" "),a("li",[e._v("ClusterRole")]),e._v(" "),a("li",[e._v("ClusterRoleList")]),e._v(" "),a("li",[e._v("ClusterRoleBinding")]),e._v(" "),a("li",[e._v("ClusterRoleBindingList")]),e._v(" "),a("li",[e._v("Role")]),e._v(" "),a("li",[e._v("RoleList")]),e._v(" "),a("li",[e._v("RoleBinding")]),e._v(" "),a("li",[e._v("RoleBindingList")]),e._v(" "),a("li",[e._v("Service")]),e._v(" "),a("li",[e._v("DaemonSet")]),e._v(" "),a("li",[e._v("Pod")]),e._v(" "),a("li",[e._v("ReplicationController")]),e._v(" "),a("li",[e._v("ReplicaSet")]),e._v(" "),a("li",[e._v("Deployment")]),e._v(" "),a("li",[e._v("HorizontalPodAutoscaler")]),e._v(" "),a("li",[e._v("StatefulSet")]),e._v(" "),a("li",[e._v("Job")]),e._v(" "),a("li",[e._v("CronJob")]),e._v(" "),a("li",[e._v("Ingress")]),e._v(" "),a("li",[e._v("APIService")])])])}),[],!1,null,null,null);a.default=t.exports}}]);