(window.webpackJsonp=window.webpackJsonp||[]).push([[223],{498:function(s,t,a){"use strict";a.r(t);var r=a(14),n=Object(r.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"springcloud-bus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#springcloud-bus"}},[s._v("#")]),s._v(" SpringCloud Bus:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/springconfig%E7%9A%8426.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/springconfig%E7%9A%8427.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/springconfig%E7%9A%8431.png",alt:""}})]),s._v(" "),t("p",[s._v("注意,这里年张图片,就代表两种广播方式")]),s._v(" "),t("p",[s._v("图 1: "),t("strong",[s._v("它是 Bus 直接通知给其中一个客户端,由这个客户端开始蔓延,传播给其他所有客户端")])]),s._v(" "),t("p",[s._v("图 2: "),t("strong",[s._v("它是通知给配置中心的服务端,有服务端广播给所有客户端")])]),s._v(" "),t("p",[t("strong",[s._v("为什么被称为总线?")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/springconfig%E7%9A%8428.png",alt:""}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("就是通过消息队列达到广播的效果\n  \t\t我们要广播每个消息时"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("主要放到某个topic中"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("所有监听的节点都可以获取到\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"使用-bus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-bus"}},[s._v("#")]),s._v(" 使用 Bus:")]),s._v(" "),t("h4",{attrs:{id:"_1-配置-rabbitmq-环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-配置-rabbitmq-环境"}},[s._v("#")]),s._v(" 1,配置 rabbitmq 环境:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/springconfig%E7%9A%8429.png",alt:""}})]),s._v(" "),t("h4",{attrs:{id:"_2-之前只有一个配置中心客户端-这里在创建一个"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-之前只有一个配置中心客户端-这里在创建一个"}},[s._v("#")]),s._v(" "),t("strong",[s._v("2,之前只有一个配置中心客户端,这里在创建一个")])]),s._v(" "),t("p",[s._v("​ =="),t("strong",[s._v("复制 3355 即可,创建为 3366")]),s._v("==")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/springconfig%E7%9A%8430.png",alt:""}})]),s._v(" "),t("p",[s._v("全部复制 3355 的即可")]),s._v(" "),t("h4",{attrs:{id:"_2-使用-bus-实现全局广播"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用-bus-实现全局广播"}},[s._v("#")]),s._v(" 2,使用 Bus 实现全局广播")]),s._v(" "),t("p",[t("strong",[s._v("Bus 广播有两种方式:")])]),s._v(" "),t("p",[s._v("​ ==就是上面两个图片的两种方式==")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/springconfig%E7%9A%8432.png",alt:""}})]),s._v(" "),t("p",[t("strong",[s._v("这两种方式,第二种跟合适,因为:")])]),s._v(" "),t("p",[s._v("​ ==第一种的缺点:==")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/springconfig%E7%9A%8433.png",alt:""}})]),s._v(" "),t("h4",{attrs:{id:"配置第二种方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置第二种方式"}},[s._v("#")]),s._v(" "),t("strong",[s._v("配置第二种方式:")])]),s._v(" "),t("h5",{attrs:{id:"_1-配置-3344-配置中心服务端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-配置-3344-配置中心服务端"}},[s._v("#")]),s._v(" "),t("strong",[s._v("1,配置 3344(配置中心服务端):")])]),s._v(" "),t("h6",{attrs:{id:"_1-修改配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-修改配置文件"}},[s._v("#")]),s._v(" 1,修改配置文件:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%841.png",alt:""}})]),s._v(" "),t("h6",{attrs:{id:"_2-添加-pom"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加-pom"}},[s._v("#")]),s._v(" 2,添加 pom")]),s._v(" "),t("p",[t("strong",[s._v("springboot 的监控组件,和消息总线")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%843.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%842.png",alt:""}})]),s._v(" "),t("h5",{attrs:{id:"_2-修改-3355-配置中心的客户端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改-3355-配置中心的客户端"}},[s._v("#")]),s._v(" 2,修改 3355(配置中心的客户端)")]),s._v(" "),t("h6",{attrs:{id:"_1-pom"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-pom"}},[s._v("#")]),s._v(" 1,pom:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%843.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%842.png",alt:"Bus的2"}})]),s._v(" "),t("h6",{attrs:{id:"_2-配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置文件"}},[s._v("#")]),s._v(" 2,配置文件:")]),s._v(" "),t("p",[s._v("==注意配置文件的名字,要改为 bootstrap.yml==")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%845.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%844",alt:"image-20200415102708661"}})]),s._v(" "),t("h5",{attrs:{id:"_3-修改-3366-也是配置中心的客户端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-修改-3366-也是配置中心的客户端"}},[s._v("#")]),s._v(" 3,修改 3366(也是配置中心的客户端)")]),s._v(" "),t("p",[s._v("​ 修改与 3355 是一模一样的")]),s._v(" "),t("h5",{attrs:{id:"_4-测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-测试"}},[s._v("#")]),s._v(" 4,测试")]),s._v(" "),t("p",[s._v("启动 7001,3344,3355,3366")]),s._v(" "),t("p",[s._v("此时修改 GitHub 上的配置文件")]),s._v(" "),t("p",[s._v("==此时只需要刷新 3344,即可让 3355,3366 动态获取最新的配置文件==")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%846.png",alt:""}})]),s._v(" "),t("p",[s._v("其原理就是:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fltrp-dera.oss-cn-hangzhou.aliyuncs.com/spring-cloud/pic/Bus%E7%9A%847.png",alt:""}})]),s._v(" "),t("p",[t("strong",[s._v("所有客户端都监听了一个 rabbitMq 的 topic,我们将信息放入这个 topic,所有客户端都可以送到,从而实时更新")])]),s._v(" "),t("h4",{attrs:{id:"配置定点通知"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置定点通知"}},[s._v("#")]),s._v(" 配置定点通知")]),s._v(" "),t("p",[s._v("​ 就是只通知部分服务,比如只通知 3355,不通知 3366")])])}),[],!1,null,null,null);t.default=n.exports}}]);